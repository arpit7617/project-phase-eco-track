<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Weather | EcoTrack</title>
  <link rel="stylesheet" href="/style.css" />
  <link rel="stylesheet" href="/weather.css" />
</head>
<body>
  <!-- üåø Navbar -->
  <nav class="navbar">
    <div class="logo">üå± EcoTrack</div>
    <div class="nav-links">
      <a href="/">Home</a>
      <a href="/weather">Weather</a>
      <a href="/aqi">AQI</a>
      <a href="/location">My Location</a>
      <a href="/community">Community</a>
    </div>
  </nav>

  <!-- üå§Ô∏è Weather Form Section -->
  <section class="weather-section">
    <h1>Check the Weather</h1>
    <form class="weather-form">
      <input type="text" placeholder="Enter your city..." required />
      <button type="submit">Get Weather</button>
    </form>
  </section>

  <!-- üìä Weather Results -->
  <section id="weather-info" class="weather-results hidden">
    <h2>Weather Report</h2>
    <p><strong>City:</strong> <span id="city">--</span></p>
    <p><strong>Temperature:</strong> <span id="temp">--</span> ¬∞C</p>
    <p><strong>Condition:</strong> <span id="condition">--</span></p>
    <p><strong>Humidity:</strong> <span id="humidity">--</span>%</p>
    <p><strong>Wind Speed:</strong> <span id="wind">--</span> km/h</p>
  </section>

  <!-- üåç Footer -->
  <footer class="footer">
    <p>&copy; 2025 EcoTrack | Promoting a Greener Tomorrow üåç</p>
  </footer>

  <!-- JS: fetch real weather from backend -->
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const form = document.querySelector('.weather-form');
      const info = document.getElementById('weather-info');

      form.addEventListener('submit', async function (e) {
        e.preventDefault();

        const cityInput = form.querySelector('input[type="text"]').value.trim();
        if (!cityInput) return;

        try {
          const response = await fetch(`/weather/api/weather?city=${encodeURIComponent(cityInput)}`);
          const data = await response.json();

          if (data.error) {
            alert(data.error);
            info.classList.add('hidden');
            return;
          }

          document.getElementById('city').textContent = data.name || cityInput;
          document.getElementById('temp').textContent = data.temp ?? '--';
          document.getElementById('condition').textContent = data.condition ?? '--';
          document.getElementById('humidity').textContent = data.humidity ?? '--';
          document.getElementById('wind').textContent = data.wind ?? '--';

          info.classList.remove('hidden');
        } catch (error) {
          alert('Failed to fetch weather data. Please try again later.');
          info.classList.add('hidden');
          console.error('Weather fetch error:', error);
        }
      });
    });
  </script>
</body>
</html>
